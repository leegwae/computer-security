# 6. 인증 및 해시함수

## 6.1 보안

- 보안의 기능
  - (1) 기밀성
  - (2) 무결성: 메시지 변조 확인, 메시지 인증(해시 함수)
  - (3) 인증: 송신자 확인
  - (4) 발신자의 부인 봉쇄: 디지털 서명
- 기밀성 위협 요소
  - 노출: 정확한 암호키를 소유하지 않은 사람이나 프로세스에게 메시지의 내용이 노출되는 것
  - 트래픽 분석: 통신자들 사이에 트래픽 패턴을 알아내는 것
- 인증 위협 요소
  - 위장
  - 내용 수정
  - 순서 수정
  - 시간 수정: 메시지의 지연과 재전송
- 부인봉쇄 위협요소
  - 부인: 수신자가 메시지 수신을 부인하거나, 발신자가 메시지의 발신을 부인



## 6.2 메시지 인증 함수

- 무결성을 어떻게 입증하는가?
- 메시지 인증자를 위한 함수
  - 메시지 암호화: 메시지 전체의 암호문이 인증자로 제공됨
  - 메시지 인증 코드(MAC): 인증자로서 적용되는 고정된 길이값(메시지의 무결성을 입증하는 값)을 만드는 메시지 및 비밀키의 공개함수
  - 해쉬함수: 임의 길이의 메시지를 고정된 길이의 해쉬 값으로 대응시키는 공개 함수로서의 인증자 제공
- 비밀키를 통한 메시지 암호화
  - 기밀성 제공: A와 B만이 비밀키를 공유하여 암/복호화가 가능
  - 단순한 인증 제공: 비밀키를 아는 A만이 해당 암호문 작성 가능
  - 서명 제공 불가능
    - 수신자가 메시지 위조 가능
    - 송신자가 메시지 부인 가능
- 공개키 암호화를 통한 메시지 암호화
  - 기밀성 제공: B만이 비밀키를 통해 복호화 가능
  - 인증 제공 불가능: 누구나 B의 공개키에 접근할 수 있어 발신자 부인, 위조 가능



## 6.3 MAC

- MAC(암호학적 점검값)을 메시지에 추가
  - 비밀키를 사용하여 생성한 작은 크기의 데이터 블록
  - 메시지와 키의 함수: MAC=$C_k(M)$

- 발신자는 메시지에 MAC를 부가하여 전송, 수신측에서 메시지를 비밀키로 복호화하여 계산한 MAC를 비교

- 수신자와 송신자만이 비밀키를 알고 있고 수신된 MAC와 계산된 MAC가 일치하면

  - 수신자: 메시지가 변경되지 않았음을 확신할 수 있음
  - 수신자: 합법적 송진자로부터 메시지가 왔다고 확신할 수 있음
  - 수신자: 합법적 순서를 확신할 수 있음

- MAC를 통한 메시지 암호화

  <img src="Images\6-1.PNG" alt="6-1" style="zoom:60%;" />

  - 메시지 내용 인증: 비밀키를 모르는 공격자는 메시지와 대응되는 점검값을 구성할 수 없음
  - 출처 인증: 비밀키를 아는 A만이 올바른 점검값 작성하여 전송 가능

  <img src="Images\6-2.PNG" alt="6-2" style="zoom:60%;" />

  - 메시지 인증 제공: A와 B만이 아는 K1을 공유(MAC)
  - 기밀성 제공: A와 B만이 아는 K2를 공유(암호화)



## 6.4 해시 함수

- 일정한 길이의 메시지 인증 코드 만들기
- H(M)=MD(message digest)
- MDC(manipulation detection codes): 키 없는 해시 함수
  - 일방향 해시 함수
    - (1) compression: 임의의 유한 길이의 input bit string을 고정된 길이의 output bit string으로 변환
    - (2) ease of computation: 주어진 해쉬 함수 h와 input x에 대하여 h(x)를 계산하기 쉽다
    - (3) preimage resistance: 주어진 출력에 대하여 입력 구하는 것 불가능
    - (4) 2-nd preimage resistance: 주어진 입력에 대하여 같은 출력을 내는 또 다른 입력 찾기 불가능
  - 충돌 회피 해쉬 함수
    - (1) compression:
    - (2) ease of computation
    - (3) preimage resistance
    - (4) 2-nd preimage resistance



### 6.4.1 해시 함수의 기본 구조

- 어떻게 임의의 길이의 메시지로 고유한 특성을 가지면서 고정된 길이의 해쉬값을 얻을 것인가?
  - 블록 단위로 자르고 값을 누적하여 함수에 넣기
- rabin은 symmetric encrpytion을 이용(함수는 DES)



### 6.4.2 해시 함수의 종류

- (1) MD5: 128비트 알고리즘
- (2) SHA, SHA-1: 160비트 알고리즘



### 6.4.3 MD5

- 입력: 임의의 길이의 메시지
- 출력: 128비트 메시지 다이제스트
- 입력처리: 512비트 블록단위로 처리

<img src="Images\6-3.PNG" alt="6-3" style="zoom:60%;" />

- MD5 과정
  - (1) 패딩 비트를 부가하기: 1 뒤에 0 붙이기
    - 메시지 + 메세지의 길이를 나타내는 64비트 + 패딩 비트 => 512비트로 나누어떨어지도록
  - (2) 512비트로 나누기
  - (3) MD 버퍼의 초기화(4개의 32비트 레지스터)
  - (4) 512비트 블록의 메시지 처리
  - (5) 출력

